{
    "AWSTemplateFormatVersion": "2010-09-09",
    "Description": "Creates nested stacks containing CodeBuild templates",
    "Parameters": {
        "UnitTestName": {
            "Description": "Name of the unittest build project",
            "Type": "String",
            "Default": "unittest"
        },
        "VerifyTestName": {
            "Description": "Name of the verify test build project",
            "Type": "String",
            "Default": "verify"
        },
        "PackagingBuildName": {
            "Description": "Name of the unittest build project",
            "Type": "String",
            "Default": "packaging"
        },
        "UnitTestBuildSpecFileName": {
            "Description": "Filename of the buildspec.yaml",
            "Type": "String",
            "Default": ""
        },
        "VerifyBuildSpecFileName": {
            "Description": "Filename of the buildspec.yaml",
            "Type": "String",
            "Default": ""
        },
        "PackagingBuildSpecFileName": {
            "Description": "Filename of the buildspec.yaml",
            "Type": "String",
            "Default": ""
        },
        "BuildImage": {
            "Description": "Docker container to run the build",
            "Type": "String",
            "Default": ""
        },
        "UnitTestTemplateURL": {
            "Description": "S3 URL for unit test template",
            "Type": "String",
            "Default": ""
        },
        "VerifyTestTemplateURL": {
            "Description": "S3 URL for verify test template",
            "Type": "String",
            "Default": ""
        },
        "PackagingTemplateURL": {
            "Description": "S3 URL for packaging build template",
            "Type": "String",
            "Default": ""
        }
    },
    "Resources": {
        "UnitTest": {
            "Type": "AWS::CloudFormation::Stack",
            "Properties": {
                "Parameters": {
                    "BuildName": {
                        "Ref": "UnitTestName"
                    },
                    "BuildImage": {
                        "Ref": "BuildImage"
                    },
                    "BuildSpecFileName": {
                        "Ref": "UnitTestBuildSpecFileName"
                    }
                },
                "TemplateURL": {
                    "Ref": "UnitTestTemplateURL"
                }
            }
        },
        "Verify": {
            "Type": "AWS::CloudFormation::Stack",
            "Properties": {
                "Parameters": {
                    "BuildName": {
                        "Ref": "VerifyTestName"
                    },
                    "BuildImage": {
                        "Ref": "BuildImage"
                    },
                    "BuildSpecFileName": {
                        "Ref": "VerifyBuildSpecFileName"
                    }
                },
                "TemplateURL": {
                    "Ref": "VerifyTestTemplateURL"
                }
            }
        },
        "Packaging": {
            "Type": "AWS::CloudFormation::Stack",
            "Properties": {
                "Parameters": {
                    "BuildName": {
                        "Ref": "PackagingBuildName"
                    },
                    "BuildImage": {
                        "Ref": "BuildImage"
                    },
                    "BuildSpecFileName": {
                        "Ref": "PackagingBuildSpecFileName"
                    }
                },
                "TemplateURL": {
                    "Ref": "PackagingTemplateURL"
                }
            }
        }
    }
}